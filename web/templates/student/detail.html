{% extends "base.html" %}

{% block title %}{{ student.name }} - Progress Report{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1>üìä Progress Report: {{ student.name }}</h1>
    <div>
        <a href="{{ url_for('session.entry') }}?student_id={{ student.id }}" class="btn btn-success">‚ö° New Session</a>
        <a href="{{ url_for('student.edit_student', student_id=student.id) }}" class="btn btn-warning">‚úèÔ∏è Edit Student</a>
    </div>
</div>

<div class="row mb-4">
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5>Student Information</h5>
            </div>
            <div class="card-body">
                <p><strong>Name:</strong> {{ student.name }}</p>
                <p><strong>Age:</strong> {{ student.age }}</p>
                {% if student.contact_info %}
                <p><strong>Contact:</strong> {{ student.contact_info }}</p>
                {% endif %}
                <p><strong>Joined:</strong> {{ student.created_at }}</p>
            </div>
        </div>
    </div>
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5>Session Statistics</h5>
            </div>
            <div class="card-body">
                <p><strong>Total Sessions:</strong> {{ sessions|length }}</p>
                {% if sessions %}
                <p><strong>Average Score:</strong> {{ "%.1f"|format(sessions|map(attribute='progress_score')|sum / sessions|length) }}/10</p>
                <p><strong>Last Session:</strong> {{ sessions[0].date }}</p>
                {% else %}
                <p class="text-muted">No sessions recorded yet</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>

{% if sessions %}
<div class="card">
    <div class="card-header">
        <h5>Session History</h5>
    </div>
    <div class="card-body">
        <div class="table-responsive">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Tutor</th>
                        <th>Duration</th>
                        <th>Progress Score</th>
                        <th>Notes</th>
                    </tr>
                </thead>
                <tbody>
                    {% for session in sessions %}
                    <tr>
                        <td>{{ session.date }}</td>
                        <td>{{ session.tutor_name }}</td>
                        <td>{{ session.duration }} min</td>
                        <td>
                            <span class="badge bg-{% if session.progress_score >= 8 %}success{% elif session.progress_score >= 6 %}warning{% else %}danger{% endif %}">
                                {{ session.progress_score }}/10
                            </span>
                        </td>
                        <td>{{ session.notes or '-' }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% else %}
<div class="text-center mt-5">
    <h3>No sessions recorded yet</h3>
    <p class="text-muted">Start tracking progress by recording the first session!</p>
    <a href="{{ url_for('session.entry') }}?student_id={{ student.id }}" class="btn btn-primary">Record First Session</a>
</div>
{% endif %}

<div class="mt-4">
    <a href="{{ url_for('student.list_students') }}" class="btn btn-secondary">‚Üê Back to Students</a>
</div>
{% endblock %}